+++
title = "[DNS] IEの インターネット オプション でプロキシサーバを設定してGGを利用している．接続先のGGサーバのAレコードを変更して接続したところ，旧サーバへ接続される．クライアント上でPINGを実行すると，新サーバの応答が得られる．"
date = "2011-12-22"
ttags = ["技術ノート"]
tcategories = ["tech"]
banner = "img/technote.jpg"
+++

-----------------------------------------------------------------------------------------------------------------------------

*技術ノート

2011/12/22*


[番号]
技術ノート KGTN 2011122001

[現象]
[DNS] IEの "インターネット オプション"
でプロキシサーバを設定してGGを利用している．接続先のGGサーバのAレコードを変更して接続したところ，旧サーバへ接続される．クライアント上でPINGを実行すると，新サーバの応答が得られる．

[説明]
先ず，PINGコマンドはTCP/IPでなくICMPで通信を行い， "web-based ping"
というような特殊なツールを除きプロキシサーバを利用しません．つまり，PINGコマンドは
（GGサーバの） 名前解決をクライアント上で行います．他方，
"インターネット オプション"
でプロキシサーバが設定された環境では，GGに入力されたGGサーバの名前はプロキシサーバ上で解決されます．PINGコマンドとGGクライアントでは，名前解決が行われる場所
（リゾルバ）
が異なりますので，このような現象が発生します．プロキシサーバが参照しているネームサーバ上で，
（GGサーバの） 名前解決がどうなるか確認して下さい．

基本的なことですが，DNSのAレコードを変更しても，その内容が直ちに反映されることはありません．出来る限り早く反映させるにはゾーンや各レコードの
TTL (Time-To-Live)
に短い値を設定する必要があります．これ以上の細かい内容については，GGのサポートの範囲を超えますので，書籍やインターネット上の情報を参照して下さい．

補足１
DNSの浸透問題 （変更した設定内容が期待通りに直ちに反映されない問題）
は，さまざまな要素が絡み理解が難しいのですが，下記のページ （ブログ）
で詳しく説明されています．

なぜ 「DNSの浸透」 は問題視されるのか 1〜6
<http://www.geekpage.jp/blog/?id=2011/10/27/1/1>

補足２
東京と大阪にGGサーバがそれぞれ１台あり，障害発生時に 東京→大阪
というようにGGサーバを切り替えたいのであれば，IPアドレスとして

;

を指定することで （２つのIPアドレスをセミコロンで区切って並べる）
，東京のGGサーバへアクセス出来ない時は自動的に大阪のGGサーバへアクセスします．なお，東京のGGサーバへのアクセスが失敗した後に大阪のGGサーバへアクセスしますので，その分ログオンに要する時間が多少長くなります．
---
*1 GGW3.2.1 と GGH4.0 それぞれで機能します．

補足３
障害発生時に準リアルタイムにGGサーバを切り替えたい場合， DNS
の機能を利用して行うことは技術的に無理があります （コストを考えなければ
IP Anycast を利用する方法があります） ．現実的には，ActiveX
クライアントを使用し，専用のウエッブページで接続先のIPアドレスを動的に切り替える方法が考えられます．


### ファイル





[KGTN2011122001.pdf](http://techreport.kitasp.net/attachments/download/764/KGTN2011122001.pdf)
 [(92.7 KB)] [kitasp 技術センター, 2011/12/22
13:11]
