+++
title = "[GGW3.2.1] VBのアプリケーションでExcelのファイルを開くが， GGW-3.2.1.4420 ではウインドウが表側に表示されていたのに， GGW-3.2.1.4510 ではウインドウが裏側に表示される．この現象は， Excel のインスタンスが存在し，かつ Excel のウインドウがメイン画面の裏側の配置されている状況で，可視設定 （Visible = True）を行った時に差異が現れる （従来は可視状態で，さらに可視設定を行うと表側に表示された） ．"
date = "2013-10-09"
tags = ["技術ノート"]
categories = ["tech"]
banner = "img/technote.jpg"
+++

-----------------------------------------------------------------------------------------------------------------------------

*技術ノート

2013/10/09*


[番号]
技術ノート KGTN 2013093001

[現象]
[GGW3.2.1] VBのアプリケーションでExcelのファイルを開くが，
GGW-3.2.1.4420 ではウインドウが表側に表示されていたのに， GGW-3.2.1.4510
ではウインドウが裏側に表示される．この現象は， Excel
のインスタンスが存在し，かつ Excel
のウインドウがメイン画面の裏側の配置されている状況で，可視設定 （Visible
= True）を行った時に差異が現れる
（従来は可視状態で，さらに可視設定を行うと表側に表示された） ．

[説明]
GGはWindowsのシステム・パラメタ SPI_GETFOREGROUNDLOCKTIMEOUT に 0
を設定しておりましたが，この設定の影響でアプリケーションをローカル環境で実行した結果とGG環境で実行した結果が異なることが分かり
（管理番号BUG#8805） ，当時の最新内部ビルド GGW-3.2.1.4456
で修正されました．

GGW-3.2.1.4456 以前のビルド GGW-3.2.1.4420 では
SPI_GETFOREGROUNDLOCKTIMEOUT = 0 が設定されておりますので，
Excelが要求を行うと無条件でウインドウがフォアグラウンドに表示されました．GGW-3.2.1.4456
以降のビルド GGW-3.2.1.4510 では SPI_GETFOREGROUNDLOCKTIMEOUT = 0
が削られておりますので，システムに設定された時間内では Excel
のフォアグラウンド要求が無視 （禁止）
されるようになりました．この動作はローカル環境で実行した場合の動作と同じで，正常な動作となります．

参考のために
GraphOn社からの情報を以下に引用します．なお，GGW-3.2.1.4420以降で類似の修正等が無いことをGraphOn社で確認しております．

参　考
アプリケーションレベルで GGW-3.2.1.4420
と同等な設定にする方法についてGraphOn社に尋ねたところ，次のコメントがありました．簡単にまとめると，同等になる可能性はありますが，しかし微妙なタイミングの問題が発生する可能性も否定出来ないため，最終的には実際に動作させて検証する必要があります．


### ファイル

 
 


[KGTN2013093001.pdf](http://techreport.kitasp.net/attachments/download/1377/KGTN2013093001.pdf)
 [(95.1 KB)] [kitasp 技術センター, 2013/10/10
06:35]


 


 

