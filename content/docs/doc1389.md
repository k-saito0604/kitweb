+++
title = "クライアントのデスクトップのスクリーンショットを撮るためExcelのマクロ機能でプリントスクリーンのイベントを発生させたが，正しい画像がキャプチャーされない．"
date = "2011-04-27"
ttags = ["技術ノート"]
tcategories = ["tech"]
banner = "img/technote.jpg"
+++

-----------------------------------------------------------------------------------------------------------------------------

*技術ノート

2011/04/27*


[番号]
技術ノート KGTN 2011042701

[現象]
クライアントのデスクトップのスクリーンショットを撮るためExcelのマクロ機能でプリントスクリーンのイベントを発生させたが，正しい画像がキャプチャーされない．

[説明]
クライアントの物理的な Print Screen キーを押下した場合は，
「GGのクライアントが」
クライアント上のデスクトップのスクリーンショットを撮ります．

サーバ上で動作するExcel
のマクロ機能でプリントスクリーンのイベントを発生させた場合は，サーバ側でスクリーンショットを撮ることになりますので，当然のことながらクライアントのデスクトップのスクリーンショットを撮ることは出来ません
（これはGGの仕様です）
．従って，クライアントのデスクトップのスクリーンショットを撮りたい場合は，マクロで

「Print Screen
キーを押下して下さい．その後，このボタンをクリックして下さい」
というダイアログを表示
クリップボードから画像
（クライアントのデスクトップのスクリーンショット） をコピー

という処理を行って下さい．なお，クライアント側のクリップボードをサーバ側で参照出来るように，クラスタマネージャで
Server Option → Client Access → Clipboard を有効にする必要があります．


### ファイル

 
 


[KGTN2011042701.pdf](http://techreport.kitasp.net/attachments/download/548/KGTN2011042701.pdf)
 [(56 KB)] [kitasp 技術センター, 2011/04/27
13:39]


 


 

