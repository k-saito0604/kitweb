+++
title = "[GGW3.2.1/GGH4.0] GGのログオンダイアログを閉じた時および認証に3回失敗した時，Microsoft Windows Services for UNIX の gwshare.exe でマウントしたドライブが切断される．"
date = "2011-11-28"
tags = ["技術ノート"]
categories = ["tech"]
banner = "img/technote.jpg"
+++

-----------------------------------------------------------------------------------------------------------------------------

*技術ノート

2011/11/28*


[番号]
技術ノート KGTN 2011110903

[現象]
[GGW3.2.1/GGH4.0]
GGのログオンダイアログを閉じた時および認証に3回失敗した時，Microsoft
Windows Services for UNIX の gwshare.exe
でマウントしたドライブが切断される．

[説明]
弊社で現象を確認し，GraphOn社へ報告をしました．この現象は GGW3.2.1 と
GGH4.0 の両方のバージョンで発生し，現時点では GGH4.0
で対応すべき課題として認識しています．GraphOn社から新たな情報が届き次第，この技術ノートを更新します．

補足１
本現象の発生シナリオは，次の通りです．

下記コマンドでUNIXのファイルシステムを指定したドライブレターでマウント
GGのログオンダイアログを閉じる または 3回認証に失敗
マウントしたネットワークドライブが切断

なお，正常にログオンしそしてログオフした場合は，マウントしたネットワークドライブが切断される現象は発生しません．

補足２
対症療法としては，以下の２つの方法が考えられます．

エンタープライズオプションのツール GMServiceで，
「ネットワークドライブが切断されているかどうか確認し，切断されていればそのネットワークドライブを再接続する」
というスクリプトを実行する．

共有したいファイルを Windows
の共有フォルダに配置し，ログオンスクリプトでその共有フォルダをマウント
（net use コマンド） する．
補足３
補足２の 1) の
「ネットワークドライブが切断されているかどうか確認し，切断されていればそのネットワークドライブを再接続する」
というスクリプトのサンプルは，以下の通りです．

補足４
ログオンダイアログを閉じた時および認証に3回失敗した時，GGは用意したセッションを解放する処理を行っております．この処理では，Windowsのファイルシステム・ベースのネットワークドライブやUNIX
ファイルシステム・ベースのネットワークドライブを特に意識しておりません．このことから，GGが利用している
Windows API の何れかがUNIX
ファイルシステム・ベースのネットワークドライブを切断しているのではないかと考えられます．原因を特定するには，UNIX
ファイルシステム・ベースのネットワークドライブの挙動を詳細に調べる必要があり，これには多くの時間と工数がかかる予想されます．仮に原因が分ったとしても，
現在のWindows
およびGGのアーキテクチャの下では，解決が困難という結論になる可能性もあります．

補足５
GGW3.0.4で本現象が発生せず，GGW3.2.1 および GGH4.0.1
で発生します．GGW3.2.1 および GGH4.0.1の新たな仕様 （機能）
の実装で使用した Windows API 等が，その副作用としてUNIX
ファイルシステム・ベースのネットワークドライブを切断する可能性も考えられます．従って，現時点で直ちにGGのバグと結論付けることは出来ません．


### ファイル

 
 


[KGTN2011110903.pdf](http://techreport.kitasp.net/attachments/download/696/KGTN2011110903.pdf)
 [(131 KB)] [kitasp 技術センター, 2011/11/28
10:50]


 


 

